<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">

<!-- Mirrored from station.jup.ag/blog/jup-v3-metis-routing-algo by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 31 Jan 2024 21:49:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Jupiter v3: The Metis Routing Algo | Jupiter Station</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="jup-v3-metis-routing-algo"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="description" content="Jupiter Station is the place for all things related to Jupiter. Here you can access comprehensive documentation, explore statistics and analytics, ecosystem partners that are integrating with Jupiter and read our latest updates."><meta data-rh="true" property="og:image" content="https://og.jup.ag/api/jupiter-station"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" property="og:title" content="Jupiter v3: The Metis Routing Algo | Jupiter Station"><meta data-rh="true" name="description" content="Metis1"><meta data-rh="true" property="og:description" content="Metis1"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-07-27T00:00:00.000Z"><link data-rh="true" rel="icon" href="../img/favicon.ico"><link data-rh="true" rel="canonical" href="jup-v3-metis-routing-algo"><link data-rh="true" rel="alternate" href="jup-v3-metis-routing-algo" hreflang="en"><link data-rh="true" rel="alternate" href="jup-v3-metis-routing-algo" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://jmcia1qg7y-dsn.algolia.net/" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="rss.xml" title="Jupiter Station RSS Feed">
<link rel="alternate" type="application/atom+xml" href="atom.xml" title="Jupiter Station Atom Feed">














<style type="text/css">@font-face {font-family:Inter;font-style:normal;font-weight:400;src:url(../cf-fonts/v/inter/5.0.16/greek/wght/normal.html);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:400;src:url(../cf-fonts/v/inter/5.0.16/greek-ext/wght/normal.html);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:400;src:url(../cf-fonts/v/inter/5.0.16/latin-ext/wght/normal.html);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:400;src:url(../cf-fonts/v/inter/5.0.16/cyrillic/wght/normal.html);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:400;src:url(../cf-fonts/v/inter/5.0.16/vietnamese/wght/normal.html);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:400;src:url(../cf-fonts/v/inter/5.0.16/cyrillic-ext/wght/normal.html);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:400;src:url(../cf-fonts/v/inter/5.0.16/latin/wght/normal.html);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:500;src:url(../cf-fonts/v/inter/5.0.16/cyrillic-ext/wght/normal.html);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:500;src:url(../cf-fonts/v/inter/5.0.16/latin/wght/normal.html);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:500;src:url(../cf-fonts/v/inter/5.0.16/cyrillic/wght/normal.html);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:500;src:url(../cf-fonts/v/inter/5.0.16/greek/wght/normal.html);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:500;src:url(../cf-fonts/v/inter/5.0.16/latin-ext/wght/normal.html);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:500;src:url(../cf-fonts/v/inter/5.0.16/vietnamese/wght/normal.html);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:500;src:url(../cf-fonts/v/inter/5.0.16/greek-ext/wght/normal.html);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:600;src:url(../cf-fonts/v/inter/5.0.16/greek-ext/wght/normal.html);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:600;src:url(../cf-fonts/v/inter/5.0.16/greek/wght/normal.html);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:600;src:url(../cf-fonts/v/inter/5.0.16/cyrillic/wght/normal.html);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:600;src:url(../cf-fonts/v/inter/5.0.16/latin/wght/normal.html);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:600;src:url(../cf-fonts/v/inter/5.0.16/latin-ext/wght/normal.html);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:600;src:url(../cf-fonts/v/inter/5.0.16/cyrillic-ext/wght/normal.html);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:600;src:url(../cf-fonts/v/inter/5.0.16/vietnamese/wght/normal.html);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:700;src:url(../cf-fonts/v/inter/5.0.16/greek/wght/normal.html);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:700;src:url(../cf-fonts/v/inter/5.0.16/greek-ext/wght/normal.html);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:700;src:url(../cf-fonts/v/inter/5.0.16/cyrillic-ext/wght/normal.html);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:700;src:url(../cf-fonts/v/inter/5.0.16/latin/wght/normal.html);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:700;src:url(../cf-fonts/v/inter/5.0.16/latin-ext/wght/normal.html);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:700;src:url(../cf-fonts/v/inter/5.0.16/vietnamese/wght/normal.html);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Inter;font-style:normal;font-weight:700;src:url(../cf-fonts/v/inter/5.0.16/cyrillic/wght/normal.html);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}</style><link rel="stylesheet" href="../assets/css/styles.e9a3d5ae.css">
<link rel="preload" href="../assets/js/runtime_main.21720f0f.js" as="script">
<link rel="preload" href="../assets/js/main.f15b6854.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_wktF" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="../index.html"><div class="navbar__logo"><img src="../img/jupiter-logo.svg" alt="Jupiter Logo" class="themedImage_EivR themedImage--light_K1FT" height="33" width="33"><img src="../img/jupiter-logo.svg" alt="Jupiter Logo" class="themedImage_EivR themedImage--dark_VHrF" height="33" width="33"></div><b class="navbar__title text--truncate">Jupiter Station</b></a><a class="navbar__item navbar__link" href="../guides">Guides</a><a class="navbar__item navbar__link" href="../docs">Docs</a><a class="navbar__item navbar__link" href="../labs">Labs</a><a class="navbar__item navbar__link" href="../start">Start</a><a class="navbar__item navbar__link" href="../partners">Partners</a><a class="navbar__item navbar__link" href="../community">Community</a><a class="navbar__item navbar__link" href="../stats">Stats</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="../blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="search searchBox_fkQ5"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="navbar__item">
            <a href="https://jup.ag/" target="_blank" class="launch-app">
              <span>
                Launch App
              </span>
            </a>
            </div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_yzqZ"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_jK5y thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_b9Nv margin-bottom--md">All posts</div><ul class="sidebarItemList_uX9r clean-list"><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jupiter-lfg-launchpad">Jupiter LFG Launchpad</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jup-pie-cats">Jup Pie Cats</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jup-start">Grow The Pie Update #2</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="grow-the-pie-1">Grow The Pie Update #1</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="green-paper">Jupiter Green Paper</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jup-native-usdc-circle-wormhole">Jupiter Bringing Native USDC to Solana, Powered by Wormhole and Circle&#x27;s CCTP</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jup-planetary-dev-update">Jupiter Planetary Developer Week</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="dca-official-launch">Jupiter DCA Is Now Officially Launched!</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jup-limit-order-upgrade">Limit Order Upgrade: Any-to-any token trading, 0% maker fee and more!</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jup-lst-with-sanctum">Jupiter LSTs Integration with Sanctum</a></li><li class="sidebarItem_wlju"><a aria-current="page" class="sidebarItemLink_AAvF sidebarItemLinkActive_RFqz" href="jup-v3-metis-routing-algo">Jupiter v3: The Metis Routing Algo</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jup-token2022-support">Jupiter Token 2022 Support</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jup-v2-major-upgrade-to-routing-engine">Jupiter v2 - A Major Upgrade to our Routing Engine!</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jupiter-token-list-api">Introducing the Jupiter Token List API</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="bonk-update">$BONK Update</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="bonk-retrieval-and-distribution-plan">$BONK Retrieval And Re-Distribution Plan</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jupiter-community-call-27-12-summary">Jupiter Community Call 27/12 Summary</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jupiter-muses-1">Jupiter Muses #1</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="unveiling-the-jup-spirit">Unveiling the JUP Spirit (🦄​ ,🪐​)</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="creating-the-jup-spirit-together">Creating The JUP Spirit Together 🦄🪐</a></li><li class="sidebarItem_wlju"><a class="sidebarItemLink_AAvF" href="jupiter-the-liquidity-infrastructure-for-solana">Jupiter: The Liquidity Infrastructure For Solana</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_NP08" itemprop="headline">Jupiter v3: The Metis Routing Algo</h1><div class="container_QXXc margin-vert--md"><time datetime="2023-07-27T00:00:00.000Z" itemprop="datePublished">July 27, 2023</time> · <!-- -->10 min read</div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="Metis1" src="../assets/images/Metis1-2369f9e80f65c3ce9297ae399c3a8054.png" width="2400" height="1350" class="img_MG2L"></p><p>Today, we are excited to announce Jupiter v3, which introduces Metis, a novel routing algorithm that further enhances our industry leading aggregator. Metis significantly improves route discovery for all pairs, substantially reduces slippage for large trades, and offers vastly improved scalability in preparation for upcoming Solana upgrades and new DEXs.</p><p>In order to be able to support Metis to run on Solana’s hyper fast blocktimes, we have also made major improvements to our backend infrastructure. In addition, we also introduce the Dollar-Cost Averaging beta, the testing of a new contract that removes the need for users to have intermediate token accounts, integrations of Limit Orders into our routing, the Jupiter space station and several new features that’s based on user feedback.</p><p>The upgrade, coming only a few months after v2, embodies our efforts to push the boundaries of Solana to offer the most powerful yet simple experience in all of crypto, and build a genuine CEX replacement to help with the inevitable migration to come.</p><p>This is obviously a mega update so let’s dive right in!</p><h2 class="anchor anchorWithStickyNavbar_CuU3" id="metis"><a href="https://en.wikipedia.org/wiki/Metis_(moon)" target="_blank" rel="noopener noreferrer"><strong>Metis</strong></a><a href="#metis" class="hash-link" aria-label="Direct link to metis" title="Direct link to metis">​</a></h2><p>Today, we introduce Metis, our new advanced routing algorithm, a heavily modified variant of the <a href="https://en.wikipedia.org/wiki/Bellman–Ford_algorithm" target="_blank" rel="noopener noreferrer">Bellman-Ford algorithm</a> catered for the key requirements of offering best price routing at scale in a very dynamic operational space.</p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="key-features">Key Features<a href="#key-features" class="hash-link" aria-label="Direct link to Key Features" title="Direct link to Key Features">​</a></h3><h3 class="anchor anchorWithStickyNavbar_CuU3" id="incremental-route-building">Incremental Route Building<a href="#incremental-route-building" class="hash-link" aria-label="Direct link to Incremental Route Building" title="Direct link to Incremental Route Building">​</a></h3><p>To find the best price, Metis streams the input tokens to incrementally build a route to split and merge at any stage. By generating the routes for each split iteratively one after another, we can also use the same DEX in different splits - allowing us to find routes with better prices with more complex trades.</p><p><img loading="lazy" alt="Metis2" src="../assets/images/Metis2-03a7d08ed027a50af4f8ed74c800d4d7.png" width="1200" height="675" class="img_MG2L"></p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="combine-route-generation-and-quoting">Combine Route Generation and Quoting<a href="#combine-route-generation-and-quoting" class="hash-link" aria-label="Direct link to Combine Route Generation and Quoting" title="Direct link to Combine Route Generation and Quoting">​</a></h3><p>To improve the efficiency of the algo, we combine route generation and quoting into a single step, allowing us to avoid generating and using bad routes, which besides improving the efficiency, also allows us to use a larger set of tokens as intermediaries.</p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="future-proofing">Future Proofing<a href="#future-proofing" class="hash-link" aria-label="Direct link to Future Proofing" title="Direct link to Future Proofing">​</a></h3><p>v2 runs fast when the total number of DEXs used is small since Solana limits us to use at most 4 DEXs in a swap <em>(due to the account lock limit of 64)</em>. Future Solana upgrades will relax this limit and allow more DEXs to be used in a single transaction. In addition, we foresee the continued growth of the Solana DeFi ecosystem, which means there will be many more DEXs emerging. </p><p>With Metis, we are well equipped to be able to handle both these trends, since the algorithm is able to scale to include more DEXs in a route when account lock limits are increased, and can support more DEXs with only a modest increase in running time.</p><p><img loading="lazy" alt="Metis3" src="../assets/images/Metis3-dae0e79b44a42caec8b0a7e0464be821.png" width="1102" height="601" class="img_MG2L"></p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="infra-upgrade">Infra Upgrade<a href="#infra-upgrade" class="hash-link" aria-label="Direct link to Infra Upgrade" title="Direct link to Infra Upgrade">​</a></h3><p>In addition, determining the cost per hop for various amounts of splits is obviously a major challenge, since there are many potential outputs for different amounts, including for vastly different liquidity venues like CLOBs and CLAMMs, and getting quotes from lots of AMMs is slow, which limited the scalability of the system.  To resolve this, we embarked on a major infra upgrade to refresh quotes in parallel and in real time.</p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="performance-improvements">Performance Improvements<a href="#performance-improvements" class="hash-link" aria-label="Direct link to Performance Improvements" title="Direct link to Performance Improvements">​</a></h3><p>The system has undergone rigorous testing over the past few weeks in production. At the same time, we have been benchmarking the performance of the algorithm. On average, Metis quotes prices that are 5.22% better than our v2 engine, with the improvements increasing sharply based on the trade size.</p><p><img loading="lazy" alt="Metis4" src="../assets/images/Metis4-c8c5df3771805adf29bcde87f555034d.jpg" width="1220" height="780" class="img_MG2L"></p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="powering-liquidity-on-solana">Powering Liquidity On Solana<a href="#powering-liquidity-on-solana" class="hash-link" aria-label="Direct link to Powering Liquidity On Solana" title="Direct link to Powering Liquidity On Solana">​</a></h3><p>And of course, this kind of insanely powerful engine will be completely out of reach for the average user in most other platforms, given the high level of gas cost this will incur. On Solana, the cost to the user will remain small and miniscule. </p><p>In addition, an great routing engine is crucial for DeFi in so many ways - liquidations require single transactions for large amounts to be as efficient as possible, new DEXs need a fair chance to be leveraged for volume as the more established ones, and of course, we need to keep on pushing the limits of Solana, so more people understand how powerful shit can get!</p><hr><h2 class="anchor anchorWithStickyNavbar_CuU3" id="dca-dollar-cost-averaging">DCA (Dollar-Cost Averaging)<a href="#dca-dollar-cost-averaging" class="hash-link" aria-label="Direct link to DCA (Dollar-Cost Averaging)" title="Direct link to DCA (Dollar-Cost Averaging)">​</a></h2><p>Secondly, we are also delighted to introduce our DCA Beta, a non-custodial, on-chain dollar cost averaging solution to automate the purchase or sale of any token.</p><p><img loading="lazy" alt="DCA1" src="../assets/images/DCA1-52f4c46adef3aa59dedab233b0016d31.png" width="1200" height="675" class="img_MG2L"></p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="how-it-works">How it works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How it works" title="Direct link to How it works">​</a></h3><p>If you choose to use USDC 900 to buy SOL daily over 9 days, 900 USDC will be transferred from your wallet to the non-custodial program and executed over the next 9 days.</p><ol><li>Your first order to sell 100 USDC for SOL will take place immediately at the best price available then.</li><li>Your second order to sell the next 100 USDC for SOL will take place approximately 24 hours after the initial order at the best price available then</li><li>Subsequently, 7 more orders will all take place approximately 24 hours after the previous order until the full DCA order has been executed. </li></ol><h3 class="anchor anchorWithStickyNavbar_CuU3" id="ease-of-use">Ease Of Use<a href="#ease-of-use" class="hash-link" aria-label="Direct link to Ease Of Use" title="Direct link to Ease Of Use">​</a></h3><p>As with all Jupiter systems, we aim to make very complex transactions as simple as possible. You will automatically receive purchased tokens in your wallet within the same transaction of each order and a link to the blockchain transaction will be visible to you on <a href="https://jup.ag/" target="_blank" rel="noopener noreferrer">jup.ag</a>.</p><p>Also, during the last order of your DCA, any remaining tokens will be sent to you and all program related accounts opened for your DCA will be closed and the rent returned to you automatically.</p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="notes">Notes<a href="#notes" class="hash-link" aria-label="Direct link to Notes" title="Direct link to Notes">​</a></h3><ul><li>To ensure best price execution, DCA keepers use Jupiter and also perform price checks against an external price data provider i.e. Birdeye.</li><li>To prevent people from querying and hijacking the order right before the order is about to be executed, orders have a + 2 ~ 30 second variability.</li><li>Note that there is a 0.1% keeper fee for DCA order executions, only taken upon successful completion.</li><li>You can read more about key details like fees and technical implementation here</li><li>For the Beta phase, we’re limited to trade only the Top 20 tokens, with a cap of $5,000 USD for each DCA order. We will progressively increase the number of support tokens and lift the order size limit as we move out of beta. </li></ul><div class="theme-admonition theme-admonition-tip alert alert--success admonition_amsr"><div class="admonitionHeading_n8eI"><span class="admonitionIcon_HzUW"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Beta phase!</div><div class="admonitionContent_qhyd"><p>DCA is still in beta! So please give us as much feedback as possible to help us help everyone accumulate as much SOL as possible! :D</p></div></div><hr><h2 class="anchor anchorWithStickyNavbar_CuU3" id="limit-order-integration-into-jupiter">Limit Order Integration Into Jupiter<a href="#limit-order-integration-into-jupiter" class="hash-link" aria-label="Direct link to Limit Order Integration Into Jupiter" title="Direct link to Limit Order Integration Into Jupiter">​</a></h2><p>At Jupiter, we aim to build the easiest limit orders in DeFi. Over the last couple of months, we have been steadily improving Jupiter limit orders behind the scenes, particularly on vastly improving the efficiency of the path discovery and order execution. Now, we are happy to share that Jupiter Limit Order has been integrated into Jupiter. </p><p>Jupiter will now compare Jupiter LO orders with the quoting engine quote price to provide users with the best possible price. This feature is especially useful for large limit orders, as they can be split, quoted, and filled by multiple Jupiter swaps. This improves the fulfilment of orders at the best price from both ends.</p><p>For example, there is a 20k USDC - RLB sell order here, being matched directly with one of the Jupiter Limit Order. Since this is the best price possible in the whole market, anyone will be able to take this order with zero slippage if they want to buy RLB.</p><p><img loading="lazy" alt="JUPLO" src="../assets/images/JUPLO-86eda03004d35bf08f9b19d3cc2839db.png" width="2400" height="1350" class="img_MG2L"></p><p>We will continue to make major improvements to the limit orders over the next few months - improving it in terms of functionality, order discovery and usability. We cannot wait to make the easiest limit orders in DeFi even better than ever!</p><p><img loading="lazy" alt="JUPLO2" src="../assets/images/JUPLO2-6b94733dc610a64bdc167ace9cf6f22a.png" width="1200" height="675" class="img_MG2L"></p><hr><h2 class="anchor anchorWithStickyNavbar_CuU3" id="jupiter-space-station">Jupiter Space Station<a href="#jupiter-space-station" class="hash-link" aria-label="Direct link to Jupiter Space Station" title="Direct link to Jupiter Space Station">​</a></h2><p>Jupiter Space Station is a comprehensive resource for everything related to Jupiter, all in one place for easy access!</p><p><img loading="lazy" alt="JupStation" src="../assets/images/JupStation-10772a79e15ceaf82aec49e0faf1a1e9.jpg" width="2808" height="1288" class="img_MG2L"></p><p><strong>Our station includes:</strong></p><ul><li>Statistics about Jupiter</li><li>Guides to using Jupiter Products</li><li>Development docs</li><li>Integration guidelines</li><li>List of partners</li></ul><h3 class="anchor anchorWithStickyNavbar_CuU3" id="open-contribution">Open Contribution<a href="#open-contribution" class="hash-link" aria-label="Direct link to Open Contribution" title="Direct link to Open Contribution">​</a></h3><p>In addition, it is an open-source system that allows anyone to contribute. You can add your protocol to the partners page, create an ELI5 user guide, or report an error in the syntax. Contributing is easy - simply add a pull request to our GitHub repository and help us make Jupiter Station even better.</p><p>Here are some examples of how our friends and users have contributed so far:</p><ul><li>An insightful <a href="../guides/community/verify-swaps-with-SolanaFM" target="_blank" rel="noopener noreferrer">article</a> authored by SolanaFM on how to verify transactions using block explorer.</li><li>Sphere <a href="https://github.com/jup-ag/space-station/pull/125" target="_blank" rel="noopener noreferrer">adding</a> their protocol into the partners page.</li><li>Enhancing our homepage with more <a href="https://github.com/jup-ag/space-station/pull/128" target="_blank" rel="noopener noreferrer">content</a>.</li></ul><p>We will be constantly improving this page, in our quest to make this the all in one and most helpful resource for everyone. In particular, we will be adding a community section too, to share a lot more about how the community can contribute!</p><hr><h2 class="anchor anchorWithStickyNavbar_CuU3" id="new-improved-features">New Improved Features<a href="#new-improved-features" class="hash-link" aria-label="Direct link to New Improved Features" title="Direct link to New Improved Features">​</a></h2><p>Jupiter v3 also features a number of smaller but important improvements based on user and developer feedback.</p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="feedback-mechanism">Feedback Mechanism<a href="#feedback-mechanism" class="hash-link" aria-label="Direct link to Feedback Mechanism" title="Direct link to Feedback Mechanism">​</a></h3><p>We have a direct feedback channel on top of our Discord support. Whenever a transaction or swap fails, there will be a quick button that prompts a feedback form. This allows users to inform us of any issues they are facing. If you miss the toast message, you can find the feedback form on the bottom-right of the site. The feedback form goes directly to the team. If you require a prompt response, please reach out to us through our official Discord channel.</p><p><img loading="lazy" alt="Feedback1" src="../assets/images/Feedback1-171a77636a8a1dacb8a964b15c6ad19e.jpg" width="2858" height="1903" class="img_MG2L"></p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="fallback-mechanisms">Fallback Mechanisms<a href="#fallback-mechanisms" class="hash-link" aria-label="Direct link to Fallback Mechanisms" title="Direct link to Fallback Mechanisms">​</a></h3><p>Aggregator works with a dozen DEXs and AMMs, and sometimes, DEX/AMM errors can cause certain routes to fail, resulting in the swap failing to go through. To improve this, our fallback mechanism will exclude any affected DEX/AMM causing errors in our trading routes and immediately refetch a new quote. Traders can then execute the new route and perform the swap without any issues. We have extended this mechanism to both Ver. Txn and Legacy routes to ensure a seamless trading experience for all our users. </p><p><img loading="lazy" alt="Fallback1" src="../assets/images/Fallback1-3f5f93d5d66de86a44399ec5b9c1fda0.jpg" width="1544" height="844" class="img_MG2L"></p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="expanded-market-selection">Expanded Market Selection<a href="#expanded-market-selection" class="hash-link" aria-label="Direct link to Expanded Market Selection" title="Direct link to Expanded Market Selection">​</a></h3><p>To optimise for a safer and more robust trading experience, we previously set a strict criteria for the pools and markets where we stimulate swaps between $250 worth of tokens, with no more than a 70% loss/price difference. In our latest update, we are also including tokens that have already had liquidity elsewhere, as well as markets with single-sided liquidity of $1,000 within 20% of market price.</p><h3 class="anchor anchorWithStickyNavbar_CuU3" id="shared-intermediate-token-accounts">Shared Intermediate Token Accounts<a href="#shared-intermediate-token-accounts" class="hash-link" aria-label="Direct link to Shared Intermediate Token Accounts" title="Direct link to Shared Intermediate Token Accounts">​</a></h3><p>We are testing a new contract that will leverage shared intermediate token accounts. The need for manually opening up intermediate token accounts has been a pain point for users given the initial setup cost and high number of potential swap failures. The new shared account feature streamlines the integration process and brings cost-saving benefits to partners and users alike.</p><h2 class="anchor anchorWithStickyNavbar_CuU3" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2><p>With v3, we carry on the 3 core Jupiter traditions:</p><ul><li><strong>Upholding the JUP Promise (Best price, Best selection, Best UX)</strong></li><li><strong>Pushing the limits and possibilities of Solana</strong></li><li><strong>Introducing super easy to use, yet powerful features for the user</strong></li></ul><p>Again, nothing will ever be perfect or done, so your feedback is super important to helping us improve - the good, bad and ugly. We will work with everyone to ensure that no matter what, Solana will be home to the very best swap experience in all of DeFi and beyond.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="jup-lst-with-sanctum"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Jupiter LSTs Integration with Sanctum</div></a><a class="pagination-nav__link pagination-nav__link--next" href="jup-token2022-support"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Jupiter Token 2022 Support</div></a></nav></main><div class="col col--2"><div class="tableOfContents_nTXA thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#metis" class="table-of-contents__link toc-highlight"><strong>Metis</strong></a><ul><li><a href="#key-features" class="table-of-contents__link toc-highlight">Key Features</a></li><li><a href="#incremental-route-building" class="table-of-contents__link toc-highlight">Incremental Route Building</a></li><li><a href="#combine-route-generation-and-quoting" class="table-of-contents__link toc-highlight">Combine Route Generation and Quoting</a></li><li><a href="#future-proofing" class="table-of-contents__link toc-highlight">Future Proofing</a></li><li><a href="#infra-upgrade" class="table-of-contents__link toc-highlight">Infra Upgrade</a></li><li><a href="#performance-improvements" class="table-of-contents__link toc-highlight">Performance Improvements</a></li><li><a href="#powering-liquidity-on-solana" class="table-of-contents__link toc-highlight">Powering Liquidity On Solana</a></li></ul></li><li><a href="#dca-dollar-cost-averaging" class="table-of-contents__link toc-highlight">DCA (Dollar-Cost Averaging)</a><ul><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How it works</a></li><li><a href="#ease-of-use" class="table-of-contents__link toc-highlight">Ease Of Use</a></li><li><a href="#notes" class="table-of-contents__link toc-highlight">Notes</a></li></ul></li><li><a href="#limit-order-integration-into-jupiter" class="table-of-contents__link toc-highlight">Limit Order Integration Into Jupiter</a></li><li><a href="#jupiter-space-station" class="table-of-contents__link toc-highlight">Jupiter Space Station</a><ul><li><a href="#open-contribution" class="table-of-contents__link toc-highlight">Open Contribution</a></li></ul></li><li><a href="#new-improved-features" class="table-of-contents__link toc-highlight">New Improved Features</a><ul><li><a href="#feedback-mechanism" class="table-of-contents__link toc-highlight">Feedback Mechanism</a></li><li><a href="#fallback-mechanisms" class="table-of-contents__link toc-highlight">Fallback Mechanisms</a></li><li><a href="#expanded-market-selection" class="table-of-contents__link toc-highlight">Expanded Market Selection</a></li><li><a href="#shared-intermediate-token-accounts" class="table-of-contents__link toc-highlight">Shared Intermediate Token Accounts</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></div></div>
<script src="../assets/js/runtime_main.21720f0f.js"></script>
<script src="../assets/js/main.f15b6854.js"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/v84a3a4012de94ce1a686ba8c167c359c1696973893317" integrity="sha512-euoFGowhlaLqXsPWQ48qSkBSCFs3DPRyiwVu3FjR96cMPx+Fr+gpWRhIafcHwqwCqWS42RZhIudOvEI+Ckf6MA==" data-cf-beacon='{"rayId":"84e5287e7a750a7b","b":1,"version":"2024.1.0","token":"ac4d3bdcea374badae66954bff9555fc"}' crossorigin="anonymous"></script>
</body>

<!-- Mirrored from station.jup.ag/blog/jup-v3-metis-routing-algo by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 31 Jan 2024 21:49:22 GMT -->
</html>